// 要求仕様ID: PLT.1-DB.1 - データベース初期データ投入
// 設計書: docs/design/database/data/ 配下のサンプルデータSQLファイル群
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

async function main() {
  console.log('🌱 データベースの初期データ投入を開始します...')

  try {
    // 1. テナントマスターデータ
    console.log('🏢 テナントマスターデータを投入中...')
    const tenants = await Promise.all([
      prisma.tenant.upsert({
        where: { tenant_id: 'TENANT001' },
        update: {},
        create: {
          tenant_id: 'TENANT001',
          tenant_code: 'acme-corp',
          tenant_name: '株式会社ACME',
          tenant_name_en: 'ACME Corporation',
          tenant_short_name: 'ACME',
          tenant_type: 'ENTERPRISE',
          domain_name: 'acme-corp.com',
          subdomain: 'acme',
          logo_url: 'https://cdn.example.com/logos/acme-corp.png',
          primary_color: '#0066CC',
          secondary_color: '#FF6600',
          timezone: 'Asia/Tokyo',
          locale: 'ja_JP',
          currency_code: 'JPY',
          date_format: 'YYYY-MM-DD',
          time_format: 'HH:mm:ss',
          admin_email: 'admin@acme-corp.com',
          contact_email: 'contact@acme-corp.com',
          phone_number: '03-1234-5678',
          address: '東京都千代田区丸の内1-1-1',
          postal_code: '100-0005',
          country_code: 'JP',
          subscription_plan: 'ENTERPRISE',
          max_users: 1000,
          max_storage_gb: 1000,
          features_enabled: JSON.stringify(['advanced_analytics', 'custom_reports', 'api_access', 'sso', 'audit_logs']),
          custom_settings: JSON.stringify({
            theme: 'corporate',
            dashboard_layout: 'advanced',
            notification_preferences: { email: true, slack: true }
          }),
          security_policy: JSON.stringify({
            password_policy: { min_length: 8, require_special_chars: true },
            session_timeout: 480,
            ip_whitelist: ['192.168.1.0/24']
          }),
          data_retention_days: 2555,
          backup_enabled: true,
          backup_frequency: 'DAILY',
          contract_start_date: new Date('2024-01-01'),
          contract_end_date: new Date('2024-12-31'),
          billing_cycle: 'ANNUAL',
          monthly_fee: 50000.0,
          setup_fee: 100000.0,
          status: 'ACTIVE',
          activation_date: new Date('2024-01-01'),
          last_login_date: new Date('2024-06-01'),
          current_users_count: 250,
          storage_used_gb: 125.5,
          api_rate_limit: 10000,
          sso_enabled: true,
          sso_provider: 'SAML',
          sso_config: JSON.stringify({
            entity_id: 'acme-corp',
            sso_url: 'https://sso.acme-corp.com/saml',
            certificate: '...'
          }),
          webhook_url: 'https://api.acme-corp.com/webhooks/skill-system',
          webhook_secret: 'webhook_secret_key_123',
          created_by: 'SYSTEM',
          notes: '大手企業向けエンタープライズプラン',
        isma.tenant.upsert({
        where: { tenant_id: 'TENANT002' },
        update: {},
        create: {
          tenant_id: 'TENANT002',
          tenant_code: 'beta-tech',
          tenant_name: 'ベータテクノロジー株式会社',
          tenant_name_en: 'Beta Technology Inc.',
          tenant_short_name: 'BetaTech',
          tenant_type: 'ENTERPRISE',
          subdomain: 'beta-tech',
          logo_url: 'https://cdn.example.com/logos/beta-tech.png',
          primary_color: '#28A745',
          secondary_color: '#6C757D',
          timezone: 'Asia/Tokyo',
          locale: 'ja_JP',
          currency_code: 'JPY',
          date_format: 'YYYY/MM/DD',
          time_format: 'HH:mm',
          admin_email: 'admin@beta-tech.co.jp',
          contact_email: 'info@beta-tech.co.jp',
          phone_number: '06-9876-5432',
          address: '大阪府大阪市北区梅田2-2-2',
          postal_code: '530-0001',
          country_code: 'JP',
          subscription_plan: 'STANDARD',
          max_users: 200,
          max_storage_gb: 100,
          features_enabled: JSON.stringify(['basic_analytics', 'standard_reports', 'api_access']),
          custom_settings: JSON.stringify({
            theme: 'modern',
            dashboard_layout: 'standard'
          }),
          security_policy: JSON.stringify({
            password_policy: { min_length: 6, require_special_chars: false },
            session_timeout: 240
          }),
          data_retention_days: 1825,
          backup_enabled: true,
          backup_frequency: 'WEEKLY',
          contract_start_date: new Date('2024-03-01'),
          contract_end_date: new Date('2025-02-28'),
          billing_cycle: 'MONTHLY',
          monthly_fee: 15000.0,
          setup_fee: 30000.0,
          status: 'ACTIVE',
          activation_date: new Date('2024-03-01'),
          last_login_date: new Date('2024-05-30'),
          current_users_count: 85,
          storage_used_gb: 23.75,
          api_rate_limit: 2000,
          sso_enabled: false,
          created_by: 'SYSTEM',
          notes: '中堅企業向けスタンダードプラン',
        },
      }),
 ]). 部署マスターデータ
    console.log('📁 部署マスターデータを投入中...')
    const departments = await Promise.all([
      prisma.department.upsert({
        where: { department_code: 'DEPT001' },
        update: {},
        create: {
          department_code: 'DEPT001',
          department_name: '経営企画本部',
          department_name_short: '経営企画',
          department_level: 1,
          department_type: 'HEADQUARTERS',
          manager_id: 'EMP000001',
          cost_center_code: 'CC001',
          budget_amount: 50000000.0,
          location: '本社ビル 10F',
          phone_number: '03-1234-5678',
          email_address: 'planning@company.com',
          establishment_date: new Date('2020-04-01'),
          department_status: 'ACTIVE',
          sort_order: 1,
          description: '会社全体の経営戦略立案・推進を担当',
        },
      }),
      prisma.department.upsert({
        where: { department_code: 'DEPT002' },
   up     department_code: 'DEPT002',
          department_name: 'システム開発部',
          department_name_short: 'システム開発',
          parent_department_id: 'DEPT001',
          department_level: 2,
          department_type: 'DEPARTMENT',
          manager_id: 'EMP000002',
          deputy_manager_id: 'EMP000003',
          cost_center_code: 'CC002',
          budget_amount: 120000000.0,
          location: '本社ビル 8F',
          phone_number: '03-1234-5679',
          email_address: 'dev@company.com',
          establishment_date: new Date('2020-04-01'),
          department_status: 'ACTIVE',
          sort_order: 2,
          description: '社内システムの開発・保守・運用を担当',
        },
      }),
    ])

    // 3. 役職マスターデータ
    console.log('👔 役職マスターデータを投入中...')iert({
        where: { position_code: 'POS001' },
        update: {},
        create: {
          position_code: 'POS001',
          position_name: '代表取締役社長',
          position_name_short: '社長',
          position_level: 1,
          position_rank: 1,
          position_category: 'EXECUTIVE',
          authority_level: 10,
          approval_limit: 999999999.99,
          salary_grade: 'E1',
          allowance_amount: 500000.0,
          is_management: true,
          is_executive: true,
          requires_approval: true,
          can_hire: true,
          can_evaluate: true,
          position_status: 'ACTIVE',
          sort_order: 1,
          description: '会社の最高責任者として経営全般を統括',
        },
      }),
      prisma.position.upsert({
        where: { position_code: 'POS002' },
        update: {},
        create: {
          position_code: 'POS002',
          position_name: '取締役',: 2,
          position_rank: 1,
          position_category: 'EXECUTIVE',
          authority_level: 9,
          approval_limit: 100000000.0,
          salary_grade: 'E2',
          allowance_amount: 300000.0,
          is_management: true,
          is_executive: true,
          requires_approval: true,
          can_hire: true,
          can_evaluate: true,
          position_status: 'ACTIVE',
          sort_order: 2,
          description: '取締役会メンバーとして経営方針決定に参画',
        },
      }),
      prisma.position.upsert({
        where: { position_code: 'POS003' },
        update: {},
        create: {
          position_code: 'PO,
          position_status: 'ACTIVE',
          sort_order: 2,
          description: '取締役会メンバーとして経営方針決定に参画',
        },
      }),
      prisma.position.upsert({
        where: { position_code: 'POS003' },
        update: {},
        create: {
          position_code: 'POS003'S003',
          position_name: '部長',
          position_name_short: '部長',
          position_level: 3,
          position_rank: 1,
          position_category: 'MANAGER',
          authority_level: 7,
          approval_limit: 10000000.0,
          salary_grade: 'M1',
          allowance_amount: 100000.0,
          is_management: true,
          is_executive: false,
          requires_approval: true,
          can_hire: true,
          can_evaluate: true,
          position_status: 'ACTIVE',
          sort_order: 3,
          description: '部門の責任者として業務全般を管理',
        },
      }),
    ])

    // 4. 職種マスターデータ
    console.log('💼 職種マスターデータを投入中...')
    const jobTypes = await Promise.all([
      prisma.jobType.upsert({
        where: { job_type_code: 'SE' },
        update: {},
        create: {
          job_type_code: 'SE',
          job_type_name: 'システムエンジニア',
          job_type_name_en: 'Systems Engineer',
          job_category: 'ENGINEERING',
          job_level: 'SENIOR',
          description: 'システムの設計・開発・テストを担当するエンジニア',
          required_experience_years: 3,
          salary_grade_min: 3,
          salary_grade_max: 6,
          career_path: 'SE → シニアSE → テックリード → エンジニアリングマネージャー',
          required_certifications: JSON.stringify(['基本情報技術者', '応用情報技術者']),
          required_skills: JSON.stringify(['Java', 'SQL', 'システム設計', '要件定義']),
          department_affinity: JSON.stringify(['開発部', 'システム部']),
          remote_work_eligible: true,
          travel_frequency: 'LOW',
          sort_order: 1,
          is_active: true,
        },
      }),
      prisma.jobType.upsert({
        where: { job_type_code: 'PM' },
        update: {},
        create: {
          job_type_code: 'PM',
          job_type_name: 'プロジェクトマネージャー',
          job_type_name_en: 'Project Manager',
          job_category: 'MANAGEMENT',
          job_level: 'MANAGER',
          description: 'プロジェクトの計画・実行・管理を統括する責任者',
          required_experience_years: 5,
          salary_grade_min: 5,
          salary_grade_max: 8,
          career_path: 'SE → リーダー → PM → 部門マネージャー',
          required_certifications: JSON.stringify(['PMP', 'プロジェクトマネージャ試験']),
          required_skills: JSON.stringify(['プロジェクト管理', 'リーダーシップ', 'コミュニケーション', 'リスク管理']),
          department_affinity: JSON.stringify(['開発部', 'PMO']),
          remote_work_eligible: true,
          travel_frequency: 'MEDIUM',
          sort_order: 2,
          is_active: true,
        },
      }),
      prisma.jobType.upsert({
        where: { job_type_code: 'QA' },
        update: {},
        create: {
          job_type_code: 'QA',
          job_type_name: '品質保証エンジニア',
          job_type_name_en: 'Quality Assurance Engineer',
          job_category: 'ENGINEERING',
          job_level: 'SENIOR',
          description: 'ソフトウェアの品質保証・テスト設計・実行を担当',
          required_experience_years: 2,
          salary_grade_min: 3,
          salary_grade_max: 6,
          career_path: 'QA → シニアQA → QAリード → QAマネージャー',
          required_certifications: JSON.stringify(['JSTQB', 'ソフトウェア品質技術者資格']),
          required_skills: JSON.stringify(['テスト設計', '自動化テスト', '品質管理', 'バグ分析']),
          department_affinity: JSON.stringify(['品質保証部', '開発部']),
          remote_work_eligible: true,
          travel_frequency: 'NONE',
          sort_order: 3,
          is_active: true,
        },
      }),
    ])

    // 5. ロールマスターデータ
    console.log('🔐 ロールマスターデータを投入中...')
    const roles = await Promise.all([
      prisma.role.upsert({
        where: { role_code: 'ROLE001' },
        update: {},
        create: {
          role_code: 'ROLE001',
          role_name: 'システム管理者',
          role_name_short: 'システム管理者',
          role_category: 'SYSTEM',
          role_level: 1,
          is_system_role: true,
          is_tenant_specific: false,
          max_users: 5,
          role_priority: 1,
          role_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 1,
          description: 'システム全体の管理権限を持つ最上位ロール',
        },
      }),
      prisma.role.upsert({
        where: { role_code: 'ROLE002' },
        update: {},
        create: {
          role_code: 'ROLE002',
          role_name: 'テナント管理者',
          role_name_short: 'テナント管理者',
          role_category: 'TENANT',
          role_level: 2,
          is_system_role: true,
          is_tenant_specific: true,
          max_users: 10,
          role_priority: 2,
          role_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 2,
          description: 'テナント内の管理権限を持つロール',
        },
      }),
      prisma.role.upsert({
        where: { role_code: 'ROLE003' },
        update: {},
        create: {
          role_code: 'ROLE003',
          role_name: '一般ユーザー',
          role_name_short: '一般ユーザー',
          role_category: 'BUSINESS',
          role_level: 3,
          is_system_role: true,
          is_tenant_specific: false,
          role_priority: 10,
          auto_assign_conditions: JSON.stringify({ default: true }),
          role_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 10,
          description: '基本的な業務機能を利用できるロール',
        },
      }),
    ])

    // 6. 権限マスターデータ
    console.log('🔑 権限マスターデータを投入中...')
    const permissions = await Promise.all([
      prisma.permission.upsert({
        where: { permission_code: 'PERM_USER_READ' },
        update: {},
        create: {
          permission_code: 'PERM_USER_READ',
          permission_name: 'ユーザー情報参照',
          permission_name_short: 'ユーザー参照',
          permission_category: 'DATA',
          resource_type: 'USER',
          action_type: 'READ',
          scope_level: 'TENANT',
          is_system_permission: true,
          requires_conditions: false,
          risk_level: 1,
          requires_approval: false,
          audit_required: true,
          permission_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 1,
          description: 'ユーザー情報の参照権限',
        },
      }),
      prisma.permission.upsert({
        where: { permission_code: 'PERM_USER_UPDATE' },
        update: {},
        create: {
          permission_code: 'PERM_USER_UPDATE',
          permission_name: 'ユーザー情報更新',
          permission_name_short: 'ユーザー更新',
          permission_category: 'DATA',
          resource_type: 'USER',
          action_type: 'UPDATE',
          scope_level: 'DEPARTMENT',
          is_system_permission: true,
          requires_conditions: true,
          condition_expression: 'department_id = :user_department_id',
          risk_level: 2,
          requires_approval: false,
          audit_required: true,
          permission_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 2,
          description: 'ユーザー情報の更新権限（同一部署のみ）',
        },
      }),
      prisma.permission.upsert({
        where: { permission_code: 'PERM_SYSTEM_ADMIN' },
        update: {},
        create: {
          permission_code: 'PERM_SYSTEM_ADMIN',
          permission_name: 'システム管理',
          permission_name_short: 'システム管理',
          permission_category: 'SYSTEM',
          resource_type: 'SYSTEM',
          action_type: 'EXECUTE',
          scope_level: 'GLOBAL',
          is_system_permission: true,
          requires_conditions: false,
          risk_level: 4,
          requires_approval: true,
          audit_required: true,
          permission_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          sort_order: 100,
          description: 'システム全体の管理権限',
        },
      }),
    ])

    // 7. スキルカテゴリマスターデータ
    console.log('🎯 スキルカテゴリマスターデータを投入中...')
    const skillCategories = await Promise.all([
      prisma.skillCategory.upsert({
        where: { category_code: 'CAT001' },
        update: {},
        create: {
          category_code: 'CAT001',
          category_name: 'プログラミング言語',
          category_name_short: 'プログラミング',
          category_name_en: 'Programming Languages',
          category_type: 'TECHNICAL',
          category_level: 1,
          category_path: '/プログラミング言語',
          is_system_category: true,
          is_leaf_category: false,
          skill_count: 25,
          evaluation_method: 'LEVEL',
          max_level: 5,
          icon_url: '/icons/programming.svg',
          color_code: '#007ACC',
          display_order: 1,
          is_popular: true,
          category_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          description: '各種プログラミング言語のスキル',
        },
      }),
      prisma.skillCategory.upsert({
        where: { category_code: 'CAT002' },
        update: {},
        create: {
          category_code: 'CAT002',
          category_name: 'Java',
          category_name_short: 'Java',
          category_name_en: 'Java',
          category_type: 'TECHNICAL',
          parent_category_id: 'CAT001',
          category_level: 2,
          category_path: '/プログラミング言語/Java',
          is_system_category: true,
          is_leaf_category: true,
          skill_count: 8,
          evaluation_method: 'LEVEL',
          max_level: 5,
          icon_url: '/icons/java.svg',
          color_code: '#ED8B00',
          display_order: 1,
          is_popular: true,
          category_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          description: 'Java言語に関するスキル',
        },
      }),
      prisma.skillCategory.upsert({
        where: { category_code: 'CAT003' },
        update: {},
        create: {
          category_code: 'CAT003',
          category_name: 'コミュニケーション',
          category_name_short: 'コミュニケーション',
          category_name_en: 'Communication',
          category_type: 'SOFT',
          category_level: 1,
          category_path: '/コミュニケーション',
          is_system_category: true,
          is_leaf_category: true,
          skill_count: 12,
          evaluation_method: 'LEVEL',
          max_level: 4,
          icon_url: '/icons/communication.svg',
          color_code: '#28A745',
          display_order: 10,
          is_popular: true,
          category_status: 'ACTIVE',
          effective_from: new Date('2025-01-01'),
          description: 'コミュニケーション能力に関するスキル',
        },
      }),
    ])

    // 8. スキルマスターデータ
    console.log('⚡ スキルマスターデータを投入中...')
    const skills = await Promise.all([
      prisma.skillItem.upsert({
        where: { skill_code: 'SKILL001' },
        update: {},
        create: {
          skill_code: 'SKILL001',
          skill_name: 'Java',
          skill_category_id: 'CAT001',
          skill_type: 'TECHNICAL',
          difficulty_level: 3,
          importance_level: 4,
        },
      }),
    ])

    // 9. 資格情報マスターデータ
    console.log('🏆 資格情報マスターデータを投入中...')
    const certifications = await Promise.all([
      prisma.certification.upsert({
        where: { certification_code: 'CERT_AWS_SAA' },
        update: {},
        create: {
          certification_code: 'CERT_AWS_SAA',
          certification_name: 'AWS Certified Solutions Architect - Associate',
          certification_name_en: 'AWS Certified Solutions Architect - Associate',
          issuer: 'Amazon Web Services',
          issuer_country: 'US',
          certification_category: 'IT',
          certification_level: 'INTERMEDIATE',
          validity_period_months: 36,
          renewal_required: true,
          renewal_requirements: '再認定試験の受験または上位資格の取得',
          exam_fee: 15000,
          exam_language: '日本語/英語',
          exam_format: 'ONLINE',
          official_url: 'https://aws.amazon.com/jp/certification/certified-solutions-architect-associate/',
          description: 'AWSクラウドでのソリューション設計・実装スキルを証明する資格',
          skill_category_id: 'SKILL_CAT_CLOUD',
          is_recommended: true,
          is_active: true,
        },
      }),
      prisma.certification.upsert({
        where: { certification_code: 'CERT_PMP' },
        update: {},
        create: {
          certification_code: 'CERT_PMP',
          certification_name: 'Project Management Professional',
          certification_name_en: 'Project Management Professional',
          issuer: 'Project Management Institute',
          issuer_country: 'US',
          certification_category: 'BUSINESS',
          certification_level: 'ADVANCED',
          validity_period_months: 36,
          renewal_required: true,
          renewal_requirements: '60 PDU（Professional Development Units）の取得',
          exam_fee: 55500,
          exam_language: '日本語/英語',
          exam_format: 'BOTH',
          official_url: 'https://www.pmi.org/certifications/project-management-pmp',
          description: 'プロジェクトマネジメントの国際的な資格',
          skill_category_id: 'SKILL_CAT_PM',
          is_recommended: true,
          is_active: true,
        },
      }),
    ])

    // 10. 従業員マスターデータ
    console.log('👤 従業員マスターデータを投入中...')
    const employees = await Promise.all([
      prisma.employee.upsert({
        where: { employee_code: 'EMP000001' },
        update: {},
        create: {
          employee_code: 'EMP000001',
          full_name: '山田太郎',
          full_name_kana: 'ヤマダタロウ',
          email: 'yamada.taro@company.com',
          phone: '090-1234-5678',
          hire_date: new Date('2020-04-01'),
          birth_date: new Date('1990-01-15'),
          gender: 'M',
          department_id: 'DEPT001',
          position_id: 'POS001',
          job_type_id: 'JOB001',
          employment_status: 'FULL_TIME',
          employee_status: 'ACTIVE',
        },
      }),
      prisma.employee.upsert({
        where: { employee_code: 'EMP000002' },
        update: {},
        create: {
          employee_code: 'EMP000002',
          full_name: '佐藤花子',
          full_name_kana: 'サトウハナコ',
          email: 'sato.hanako@company.com',
          phone: '090-2345-6789',
          hire_date: new Date('2021-04-01'),
          birth_date: new Date('1992-03-20'),
          gender: 'F',
          department_id: 'DEPT002',
          position_id: 'POS002',
          job_type_id: 'JOB002',
          employment_status: 'FULL_TIME',
          manager_id: 'EMP000001',
          employee_status: 'ACTIVE',
        },
      }),
      // 管理者ユーザー
      prisma.employee.upsert({
        where: { employee_code: 'ADMIN001' },
        update: {},
        create: {
          employee_code: 'ADMIN001',
          full_name: 'システム管理者',
          full_name_kana: 'システムカンリシャ',
          email: 'admin@skill-report.local',
          hire_date: new Date('2025-01-01'),
          department_id: 'DEPT001',
          position_id: 'POS001',
          employment_status: 'FULL_TIME',
          employee_status: 'ACTIVE',
        },
      }),
    ])

    // 11. 認証情報の作成
    console.log('🔐 認証情報を作成中...')
    const userAuths = await Promise.all([
      prisma.userAuth.upsert({
