# プロジェクト固有ルール: 年間スキル報告書WEB化PJT

## エグゼクティブサマリー

この文書は年間スキル報告書WEB化プロジェクトに特化した開発ルールと技術仕様を定義します。Next.js 14 + TypeScript + PostgreSQL技術スタック、シングルテナント設計から将来のマルチテナント化への移行戦略、要求仕様ID体系、AI駆動開発手法を提供し、7週間での実用的なシステム完成を目指します。汎用的な開発ルールは00-core-rules.mdを参照し、このファイルではプロジェクト固有の技術的制約と業務要件に焦点を当てています。

## プロジェクト基本情報

### プロジェクト概要
- **プロジェクト名**: 年間スキル報告書WEB化PJT
- **目的**: AI駆動開発の知見獲得 + 業務効率化・可視化の実現
- **技術スタック**: Next.js 14 + TypeScript + React 18 + Tailwind CSS + PostgreSQL + Docker
- **開発期間**: 2025年5月開始（現在進行中）
- **現在の実装**: シングルテナント設計で開発中（将来的にマルチテナント化を検討）

### 開発体制
- **責任者**: 黒澤 (@yusuke-kurosawa)
- **PM**: 中島 (@SAS-nakajima)  
- **PL**: 笹尾 (@SAS-sasao)

## 現在の実装方針（シングルテナント）

### 基本方針
- **実用性重視**: 7週間での完成を重視した実用的な設計
- **段階的アプローチ**: シングルテナント実装を完成後、将来的にマルチテナント化を検討
- **AI駆動開発**: AI活用による開発効率化と知見獲得
- **品質確保**: 基本機能の確実な動作を優先

### 設計方針
- **シンプルな設計**: 複雑性を排除した理解しやすい構造
- **拡張性考慮**: 将来のマルチテナント化を見据えた設計
- **実装完成**: フロントエンド画面モック完成、バックエンドAPI実装中
- **段階的機能追加**: 基本機能から順次機能を拡張

### 将来のマルチテナント要件（Phase 2以降）
- **複数のホールディングス・グループ会社での独立したデータ管理**
- 各会社（テナント）のデータ・設定・UI・権限の完全分離
- 統合管理による全体最適化とコスト効率化
- 将来的な新規グループ会社追加への対応

## 要求仕様ID体系

### カテゴリ分類
- **TNT**: Multi-Tenant (マルチテナント基盤要件)
- **PLT**: Platform (システム基盤要件)
- **ACC**: Access Control (ユーザー権限管理)
- **PRO**: Profile (個人プロフィール管理)
- **SKL**: Skill (スキル情報管理)
- **CAR**: Career (目標・キャリア管理)
- **WPM**: Work Performance Mgmt (作業実績管理)
- **TRN**: Training (研修・セミナー管理)
- **RPT**: Report (レポート出力)
- **NTF**: Notification (通知・連携サービス)

### 優先度基準
- **最高**: 業務フロー起点（ログイン、基本情報・スキル管理、マルチテナント基盤）
- **高**: 最低限の非機能（認証、権限、セキュリティ）、スキル管理・検索
- **中**: 日常業務運用（目標管理、作業実績、研修管理）
- **低**: 補助的機能（一括登録、レポート出力、分析・可視化）

### 実装優先順序（現実ベース）
1. **Phase 1**: 最高優先度（PLT.1-WEB.1, PRO.1-BASE.1, SKL.1-HIER.1）
2. **Phase 2**: 高優先度（認証・権限、スキル検索）
3. **Phase 3**: 中優先度（目標管理、作業実績、研修管理）
4. **Phase 4**: 低優先度（レポート出力、分析機能）

## 技術スタック特化ルール

### Next.js 14 + App Router
- **App Router必須**: Pages Routerは使用禁止
- **Server Actions活用**: フォーム処理・データ更新はServer Actions優先
- **API Routes**: 外部連携・複雑なロジックのみAPI Routes使用
- **TypeScript厳密モード**: strict: true, noImplicitAny: true必須

### マルチテナント対応
- **テナントID分離**: 全データアクセスでテナントID必須
- **JWT + テナント識別**: 認証トークンにテナント情報を含める
- **UI分離**: テナント別カラーテーマ・ロゴ設定
- **通知分離**: テナント別メール・Teams・LINE WORKS設定

### PostgreSQL + Prisma
- **Prisma必須**: 生SQLは特別な場合のみ許可
- **シングルテナント設計**: 現在の実装に合わせたスキーマ設計
- **型安全性**: Prisma Clientの型を活用
- **マイグレーション**: prisma migrateによる管理

### Docker環境最適化
- **Docker Compose**: 開発環境の統一
- **PostgreSQL**: コンテナ化されたデータベース
- **環境変数**: .env による設定管理

## 開発・実装ルール

### 必須事項
1. **要求仕様IDの明記**: 全実装に対応する要求仕様IDをコメントで記載
2. **画面ID・API IDの統一**: 設計書と実装でIDを一致させる
3. **TypeScript型安全性**: 厳密な型定義を必須とする
4. **レスポンシブ対応**: 全画面でマルチデバイス対応を実装
5. **マルチテナント対応**: 全機能でテナント分離を実装

### 非機能要件の必須実装
- **パフォーマンス**: API〜UI まで1秒以内
- **アクセシビリティ**: WCAG 2.1 AA準拠
- **セキュリティ**: AES-256暗号化、TLS必須
- **監査証跡**: 90日間ログ保持
- **マルチテナント分離**: テナント間データアクセス防止

## ファイル構成・命名規則

### ドキュメント構造
```
docs/
├── requirements/           # 要件定義関連
├── design/                # 設計関連
│   ├── screens/           # 画面設計
│   ├── api/              # API設計
│   ├── database/         # データベース設計
│   ├── batch/            # バッチ設計
│   ├── architecture/     # アーキテクチャ設計
│   └── interfaces/       # インターフェース設計
└── testing/              # テスト関連
```

### 設計書命名規則
- **画面設計書**: `画面設計書_SCR-{画面ID}_{画面名称}.md`
- **API仕様書**: `API仕様書_API-{API番号}_{API名称}.md`
- **テーブル定義書**: `テーブル定義書_TBL-{テーブル番号}_{テーブル名称}.md`
- **バッチ仕様書**: `バッチ仕様書_BATCH-{バッチ番号}_{バッチ名称}.md`

### ソースコード構造
```
src/
├── app/                   # Next.js App Router
│   ├── (tenant)/         # テナント別ルーティング
│   ├── api/              # API Routes
│   └── globals.css       # グローバルスタイル
├── components/           # Reactコンポーネント
│   ├── ui/              # 共通UIコンポーネント
│   ├── tenant/          # テナント別コンポーネント
│   └── dashboard/       # ダッシュボード関連
├── lib/                 # ユーティリティ・設定
│   ├── auth.ts          # 認証関連
│   ├── prisma.ts        # Prisma設定
│   └── tenant.ts        # マルチテナント関連
└── types/               # TypeScript型定義
```

## AI駆動開発の基本方針

### AI活用必須領域
1. **コード生成**: 定型的なCRUD操作、バリデーション
2. **テスト生成**: ユニット・統合・E2Eテストケース
3. **ドキュメント生成**: API仕様書、コメント
4. **設計支援**: アーキテクチャ提案、技術選定

## 品質保証・成功指標

### 品質ゲート
- **テストカバレッジ**: 80%以上を維持
- **静的解析**: 重大な問題0件
- **セキュリティ**: 脆弱性スキャン通過
- **パフォーマンス**: レスポンス時間1秒以内
- **マルチテナント**: テナント間データ漏洩0件

### 成功指標（KPI）
- **開発効率**: AI活用率、開発速度、品質指標
- **業務改善**: 作業時間50%削減、エラー70%削減、利用率90%以上
- **システム品質**: 可用性99.5%以上、レスポンス時間1秒以内95%達成
- **マルチテナント**: テナント追加時間24時間以内

## 必須確認事項・禁止事項

### 必須確認事項
1. **要求仕様ID**: 全実装で対応IDを明確化
2. **設計書整合性**: 画面・API・DB設計の一貫性
3. **非機能要件**: パフォーマンス・セキュリティ・アクセシビリティ
4. **マルチテナント対応**: テナント分離の実装確認


### 禁止事項
- 要求仕様IDなしの実装
- 設計書との不整合
- 非機能要件の未実装
- マルチテナント分離の未実装
- Pages Routerの使用
- 生SQLの多用（Prisma優先）

---

この プロジェクト固有ルールに従って、年間スキル報告書WEB化PJTの開発を効率的かつ高品質に進めてください。
