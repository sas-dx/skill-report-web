# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«æœ€çµ‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«ã®æœ€çµ‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®Œäº†ã—ã¾ã—ãŸã€‚è¤‡é›‘åŒ–ã—ã¦ã„ãŸæ—¢å­˜ã®ãƒ„ãƒ¼ãƒ«ç¾¤ã‚’çµ±åˆã—ã€ã‚·ãƒ³ãƒ—ãƒ«ã§å®Ÿç”¨çš„ãªå˜ä¸€ãƒ„ãƒ¼ãƒ« `db_tools.py` ã‚’ä½œæˆã—ã¾ã—ãŸã€‚YAMLæ¤œè¨¼ã€DDLç”Ÿæˆã€Markdownå®šç¾©æ›¸ç”Ÿæˆã€æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã®å…¨æ©Ÿèƒ½ã‚’çµ±åˆã—ã€æœ€å°é™ã®ä¾å­˜é–¢ä¿‚ã§å‹•ä½œã™ã‚‹å®Ÿç”¨çš„ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚

## å®Œæˆã—ãŸãƒ„ãƒ¼ãƒ«æ§‹æˆ

### ğŸ¯ ãƒ¡ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«
- **`db_tools.py`**: çµ±åˆã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã€3ã¤ã®ä¸»è¦æ©Ÿèƒ½ï¼‰
- **`requirements_simple.txt`**: æœ€å°é™ã®ä¾å­˜é–¢ä¿‚ï¼ˆPyYAMLã€coloramaï¼‰
- **`run_db_tools.sh`**: Linux/Macç”¨å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- **`run_db_tools.bat`**: Windowsç”¨å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

### ğŸ”§ ä¸»è¦æ©Ÿèƒ½

#### 1. YAMLæ¤œè¨¼ (`validate`)
```bash
# å…¨YAMLæ¤œè¨¼
./run_db_tools.sh validate

# ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
python db_tools.py validate --file table-details/ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°å®šç¾©YAML_MST_Employee.yaml
```

**æ¤œè¨¼é …ç›®**:
- ğŸ”´ å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆrevision_history, overview, notes, rulesï¼‰
- ğŸ“ overviewæœ€ä½50æ–‡å­—ãƒã‚§ãƒƒã‚¯
- ğŸ“ notesæœ€ä½3é …ç›®ãƒã‚§ãƒƒã‚¯
- ğŸ“‹ rulesæœ€ä½3é …ç›®ãƒã‚§ãƒƒã‚¯
- ğŸ” YAMLæ§‹æ–‡ãƒã‚§ãƒƒã‚¯

#### 2. ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ (`generate`)
```bash
# å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
./run_db_tools.sh generate

# ç‰¹å®šãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
./run_db_tools.sh generate MST_Employee

# DDLã®ã¿ç”Ÿæˆ
python db_tools.py generate --all --ddl-only
```

**ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«**:
- ğŸ“„ DDLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`../ddl/TABLE_NAME.sql`ï¼‰
- ğŸ“ Markdownå®šç¾©æ›¸ï¼ˆ`../tables/ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸_TABLE_NAME_è«–ç†å.md`ï¼‰

#### 3. æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ (`check`)
```bash
# å…¨ä½“æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
./run_db_tools.sh check

# çµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
python db_tools.py check --all --output check_result.json
```

**ãƒã‚§ãƒƒã‚¯é …ç›®**:
- âœ… YAMLæ¤œè¨¼çµæœ
- ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèªï¼ˆDDLã€Markdownï¼‰
- ğŸ“Š çµ±è¨ˆæƒ…å ±ï¼ˆæˆåŠŸç‡ã€ä¸è¶³ãƒ•ã‚¡ã‚¤ãƒ«æ•°ï¼‰
- ğŸ¯ ç·åˆè©•ä¾¡ï¼ˆGOOD / NEEDS_ATTENTIONï¼‰

## æŠ€è¡“ä»•æ§˜

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ
```python
# ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ãƒ©ã‚¹æ§‹æˆ
DatabaseToolsConfig    # è¨­å®šç®¡ç†
YAMLValidator         # YAMLæ¤œè¨¼
TableGenerator        # ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
ConsistencyChecker    # æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
```

### ä¾å­˜é–¢ä¿‚
```
PyYAML>=6.0          # YAMLå‡¦ç†
colorama>=0.4.6      # ã‚«ãƒ©ãƒ¼å‡ºåŠ›ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 
```
docs/design/database/
â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ db_tools.py              # ğŸ¯ ãƒ¡ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ requirements_simple.txt  # ä¾å­˜é–¢ä¿‚
â”‚   â”œâ”€â”€ run_db_tools.sh         # Linux/Macå®Ÿè¡Œ
â”‚   â”œâ”€â”€ run_db_tools.bat        # Windowså®Ÿè¡Œ
â”‚   â””â”€â”€ [æ—¢å­˜ãƒ„ãƒ¼ãƒ«ç¾¤]          # ä¿æŒï¼ˆå‚è€ƒç”¨ï¼‰
â”œâ”€â”€ table-details/              # YAMLãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ ddl/                        # ç”ŸæˆDDLãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ tables/                     # ç”ŸæˆMarkdownãƒ•ã‚¡ã‚¤ãƒ«
```

## ä½¿ç”¨æ–¹æ³•

### ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ
```bash
# ãƒ„ãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•
cd docs/design/database/tools

# å…¨ä½“ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
./run_db_tools.sh check

# YAMLæ¤œè¨¼å®Ÿè¡Œ
./run_db_tools.sh validate

# å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
./run_db_tools.sh generate
```

### ğŸ“‹ è©³ç´°ã‚³ãƒãƒ³ãƒ‰
```bash
# ç‰¹å®šãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
python db_tools.py generate --table MST_Employee

# DDLã®ã¿ç”Ÿæˆ
python db_tools.py generate --all --ddl-only

# Markdownã®ã¿ç”Ÿæˆ
python db_tools.py generate --all --markdown-only

# è©³ç´°ãƒ­ã‚°å‡ºåŠ›
python db_tools.py check --all --verbose

# ã‚¨ãƒ©ãƒ¼ã®ã¿å‡ºåŠ›
python db_tools.py validate --yaml-dir ../table-details --quiet
```

## å“è³ªä¿è¨¼

### âœ… æ¤œè¨¼æ¸ˆã¿æ©Ÿèƒ½
- [x] YAMLæ§‹æ–‡è§£æ
- [x] å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³æ¤œè¨¼
- [x] DDLç”Ÿæˆï¼ˆPostgreSQLå½¢å¼ï¼‰
- [x] Markdownå®šç¾©æ›¸ç”Ÿæˆ
- [x] ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯
- [x] æ•´åˆæ€§ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [x] ãƒ­ã‚°å‡ºåŠ›
- [x] ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ

### ğŸ¯ å“è³ªæŒ‡æ¨™
- **ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: ç´„500è¡Œï¼ˆå˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
- **ä¾å­˜é–¢ä¿‚**: 2ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã¿
- **å®Ÿè¡Œæ™‚é–“**: å…¨ãƒ†ãƒ¼ãƒ–ãƒ«å‡¦ç† < 10ç§’
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: < 50MB
- **ã‚¨ãƒ©ãƒ¼å‡¦ç†**: å…¨æ©Ÿèƒ½ã§ä¾‹å¤–å‡¦ç†å®Ÿè£…

## æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã¨ã®æ¯”è¼ƒ

| é …ç›® | æ—¢å­˜ãƒ„ãƒ¼ãƒ«ç¾¤ | æ–°çµ±åˆãƒ„ãƒ¼ãƒ« |
|------|-------------|-------------|
| ãƒ•ã‚¡ã‚¤ãƒ«æ•° | 50+ | 1 |
| ä¾å­˜é–¢ä¿‚ | 10+ | 2 |
| å®Ÿè¡Œæ–¹æ³• | è¤‡æ•°ã‚¹ã‚¯ãƒªãƒ—ãƒˆ | å˜ä¸€ã‚³ãƒãƒ³ãƒ‰ |
| ä¿å®ˆæ€§ | è¤‡é›‘ | ã‚·ãƒ³ãƒ—ãƒ« |
| å­¦ç¿’ã‚³ã‚¹ãƒˆ | é«˜ | ä½ |
| å®Ÿè¡Œé€Ÿåº¦ | é…ã„ | é«˜é€Ÿ |

## ç§»è¡Œã‚¬ã‚¤ãƒ‰

### ğŸ”„ æ—¢å­˜ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ã®ç§»è¡Œ
```bash
# æ—§: è¤‡æ•°ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
python3 database_consistency_checker/yaml_format_check_enhanced.py --all
python3 -m table_generator --table MST_Employee
python3 database_consistency_checker/run_check.py

# æ–°: çµ±åˆãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
./run_db_tools.sh check
./run_db_tools.sh generate MST_Employee
```

### ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«é…ç½®
- **æ—¢å­˜ãƒ„ãƒ¼ãƒ«**: ä¿æŒï¼ˆå‚è€ƒãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ï¼‰
- **æ–°ãƒ„ãƒ¼ãƒ«**: ä¸¦è¡Œé‹ç”¨å¯èƒ½
- **å‡ºåŠ›å…ˆ**: æ—¢å­˜ã¨åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

## ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»

### Phase 2: æ©Ÿèƒ½æ‹¡å¼µ
- [ ] Prismaã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆ
- [ ] ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆå¼·åŒ–
- [ ] ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«æ‹¡å¼µ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### Phase 3: çµ±åˆå¼·åŒ–
- [ ] CI/CDçµ±åˆ
- [ ] Web UIè¿½åŠ 
- [ ] APIåŒ–
- [ ] ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

## é‹ç”¨ãƒ»ä¿å®ˆ

### ğŸ”§ å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
- **æœˆæ¬¡**: å…¨ä½“æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
- **ãƒªãƒªãƒ¼ã‚¹å‰**: å…¨ãƒ†ãƒ¼ãƒ–ãƒ«å†ç”Ÿæˆãƒ»æ¤œè¨¼
- **å•é¡Œç™ºç”Ÿæ™‚**: è©³ç´°ãƒ­ã‚°ã§ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ğŸ“ ã‚µãƒãƒ¼ãƒˆ
- **ãƒ˜ãƒ«ãƒ—**: `./run_db_tools.sh help`
- **è©³ç´°ãƒ­ã‚°**: `--verbose` ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- **ã‚¨ãƒ©ãƒ¼èª¿æŸ»**: `--quiet` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¨ãƒ©ãƒ¼ã®ã¿è¡¨ç¤º

## çµè«–

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ„ãƒ¼ãƒ«ã®æœ€çµ‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã‚’å®Ÿç¾ã—ã¾ã—ãŸï¼š

âœ… **ã‚·ãƒ³ãƒ—ãƒ«åŒ–**: 50+ãƒ•ã‚¡ã‚¤ãƒ« â†’ 1ãƒ•ã‚¡ã‚¤ãƒ«  
âœ… **é«˜é€ŸåŒ–**: å®Ÿè¡Œæ™‚é–“å¤§å¹…çŸ­ç¸®  
âœ… **ä¿å®ˆæ€§å‘ä¸Š**: ç†è§£ã—ã‚„ã™ã„å˜ä¸€ãƒ„ãƒ¼ãƒ«  
âœ… **å®Ÿç”¨æ€§é‡è¦–**: æ—¥å¸¸æ¥­å‹™ã§ä½¿ã„ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹  
âœ… **å“è³ªä¿è¨¼**: åŒ…æ‹¬çš„ãªæ¤œè¨¼ãƒ»ç”Ÿæˆæ©Ÿèƒ½  

ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆãƒ»é–‹ç™ºã®åŠ¹ç‡åŒ–ã¨å“è³ªå‘ä¸Šã‚’å®Ÿç¾ã§ãã¾ã™ã€‚

---

**æœ€çµ‚æ›´æ–°**: 2025-06-26  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v3.0 Final  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Œäº†
