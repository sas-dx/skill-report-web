# ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸: WRK_BatchJobLog (ä¸€æ‹¬ç™»éŒ²ã‚¸ãƒ§ãƒ–ãƒ­ã‚°)

## ðŸ“‹ åŸºæœ¬æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ†ãƒ¼ãƒ–ãƒ«å | WRK_BatchJobLog |
| è«–ç†å | ä¸€æ‹¬ç™»éŒ²ã‚¸ãƒ§ãƒ–ãƒ­ã‚° |
| ã‚«ãƒ†ã‚´ãƒª | ãƒ¯ãƒ¼ã‚¯ç³» |
| ä½œæˆæ—¥ | 2025-06-01 |

> **æ³¨æ„**: æœ¬ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚æ‰‹å‹•ç·¨é›†ã¯è¡Œã‚ãªã„ã§ãã ã•ã„ã€‚
> è©³ç´°å®šç¾©ã®å¤‰æ›´ã¯ `table-details/WRK_BatchJobLog_details.yaml` ã§è¡Œã£ã¦ãã ã•ã„ã€‚

## ðŸ“ ãƒ†ãƒ¼ãƒ–ãƒ«æ¦‚è¦

ä¸€æ‹¬ç™»éŒ²ãƒ»æ›´æ–°å‡¦ç†ã®ã‚¸ãƒ§ãƒ–å®Ÿè¡Œãƒ­ã‚°ã‚’ç®¡ç†ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ç³»ãƒ†ãƒ¼ãƒ–ãƒ«ã€‚

ä¸»ãªç›®çš„ï¼š
- ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè¡ŒçŠ¶æ³ç›£è¦–
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®åŽŸå› èª¿æŸ»ãƒ»ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- å‡¦ç†çµæžœã®çµ±è¨ˆæƒ…å ±ç®¡ç†
- ä¸€æ‹¬å‡¦ç†ã®é€²æ—è¿½è·¡

ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ä¸€æ™‚çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦æ©Ÿèƒ½ã—ã€å‡¦ç†å®Œäº†å¾Œã¯å®šæœŸçš„ã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ»å‰Šé™¤ã•ã‚Œã‚‹ã€‚
ä¸»ã«ç®¡ç†è€…ç”»é¢ã§ã®ç›£è¦–ã¨APIçµŒç”±ã§ã®çŠ¶æ³ç¢ºèªã«ä½¿ç”¨ã•ã‚Œã‚‹ã€‚

## ðŸ—‚ï¸ ã‚«ãƒ©ãƒ å®šç¾©

### å…±é€šã‚«ãƒ©ãƒ 

| ã‚«ãƒ©ãƒ å | è«–ç†å | ãƒ‡ãƒ¼ã‚¿åž‹ | æ¡æ•° | NULL | PK | FK | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|----------|--------|----------|------|------|----|----|------------|------|
| id | ID | VARCHAR | 50 | Ã— | â— |  |  | ãƒ—ãƒ©ã‚¤ãƒžãƒªã‚­ãƒ¼ï¼ˆUUIDï¼‰ |
| is_deleted | å‰Šé™¤ãƒ•ãƒ©ã‚° | BOOLEAN |  | Ã— |  |  | false | è«–ç†å‰Šé™¤ãƒ•ãƒ©ã‚° |
| tenant_id | ãƒ†ãƒŠãƒ³ãƒˆID | VARCHAR | 50 | Ã— |  |  |  | ãƒžãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè­˜åˆ¥å­ |
| created_at | ä½œæˆæ—¥æ™‚ | TIMESTAMP |  | Ã— |  |  | CURRENT_TIMESTAMP | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆæ—¥æ™‚ |
| updated_at | æ›´æ–°æ—¥æ™‚ | TIMESTAMP |  | Ã— |  |  | CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ—¥æ™‚ |
| created_by | ä½œæˆè€… | VARCHAR | 50 | Ã— |  |  |  | ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆè€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |
| updated_by | æ›´æ–°è€… | VARCHAR | 50 | Ã— |  |  |  | ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°è€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |

### æ¥­å‹™å›ºæœ‰ã‚«ãƒ©ãƒ 

| ã‚«ãƒ©ãƒ å | è«–ç†å | ãƒ‡ãƒ¼ã‚¿åž‹ | æ¡æ•° | NULL | PK | FK | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|----------|--------|----------|------|------|----|----|------------|------|
| job_id | ã‚¸ãƒ§ãƒ–ID | VARCHAR | 50 | Ã— |  |  |  | ä¸€æ‹¬å‡¦ç†ã‚¸ãƒ§ãƒ–ã®ä¸€æ„è­˜åˆ¥å­ï¼ˆUUIDå½¢å¼ï¼‰ |
| job_name | ã‚¸ãƒ§ãƒ–å | VARCHAR | 200 | Ã— |  |  |  | å®Ÿè¡Œã•ã‚ŒãŸã‚¸ãƒ§ãƒ–ã®åç§°ï¼ˆç”»é¢è¡¨ç¤ºç”¨ï¼‰ |
| job_type | ã‚¸ãƒ§ãƒ–ç¨®åˆ¥ | ENUM |  | Ã— |  |  | 'SKILL_IMPORT' | ã‚¸ãƒ§ãƒ–ã®ç¨®åˆ¥ï¼ˆSKILL_IMPORT, EMPLOYEE_IMPORT, BULK_UPDATE, BULK_DELETE, DATA_EXPORTï¼‰ |
| status | å®Ÿè¡Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | ENUM |  | Ã— |  |  | 'PENDING' | ã‚¸ãƒ§ãƒ–ã®å®Ÿè¡ŒçŠ¶æ³ï¼ˆPENDING, RUNNING, COMPLETED, FAILED, CANCELLEDï¼‰ |
| start_time | é–‹å§‹æ™‚åˆ» | TIMESTAMP |  | â—‹ |  |  |  | ã‚¸ãƒ§ãƒ–å®Ÿè¡Œé–‹å§‹æ—¥æ™‚ |
| end_time | çµ‚äº†æ™‚åˆ» | TIMESTAMP |  | â—‹ |  |  |  | ã‚¸ãƒ§ãƒ–å®Ÿè¡Œçµ‚äº†æ—¥æ™‚ |
| total_records | ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•° | INTEGER |  | Ã— |  |  | 0 | å‡¦ç†å¯¾è±¡ã®ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•° |
| processed_records | å‡¦ç†æ¸ˆã¿ãƒ¬ã‚³ãƒ¼ãƒ‰æ•° | INTEGER |  | Ã— |  |  | 0 | å®Ÿéš›ã«å‡¦ç†ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° |
| success_records | æˆåŠŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° | INTEGER |  | Ã— |  |  | 0 | æ­£å¸¸ã«å‡¦ç†ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° |
| error_records | ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰æ•° | INTEGER |  | Ã— |  |  | 0 | ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•° |
| error_details | ã‚¨ãƒ©ãƒ¼è©³ç´° | TEXT |  | â—‹ |  |  |  | ã‚¨ãƒ©ãƒ¼å†…å®¹ã®è©³ç´°æƒ…å ±ï¼ˆJSONå½¢å¼ï¼‰ |
| input_file_path | å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | VARCHAR | 500 | â—‹ |  |  |  | å‡¦ç†å¯¾è±¡ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆCSVãƒ•ã‚¡ã‚¤ãƒ«ç­‰ï¼‰ |
| output_file_path | å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | VARCHAR | 500 | â—‹ |  |  |  | å‡¦ç†çµæžœã®å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç­‰ï¼‰ |
| executed_by | å®Ÿè¡Œè€… | VARCHAR | 50 | Ã— |  | â— |  | ã‚¸ãƒ§ãƒ–ã‚’å®Ÿè¡Œã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ID |
| progress_percentage | é€²æ—çŽ‡ | DECIMAL | 5,2 | Ã— |  |  | 0.00 | ã‚¸ãƒ§ãƒ–ã®é€²æ—çŽ‡ï¼ˆ0.00-100.00ï¼‰ |
| execution_environment | å®Ÿè¡Œç’°å¢ƒ | VARCHAR | 100 | â—‹ |  |  |  | ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚ŒãŸç’°å¢ƒæƒ…å ±ï¼ˆã‚µãƒ¼ãƒãƒ¼åã€ãƒ—ãƒ­ã‚»ã‚¹IDç­‰ï¼‰ |
| job_parameters | ã‚¸ãƒ§ãƒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | TEXT |  | â—‹ |  |  |  | ã‚¸ãƒ§ãƒ–å®Ÿè¡Œæ™‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æƒ…å ±ï¼ˆJSONå½¢å¼ï¼‰ |

## ðŸ”— å¤–éƒ¨ã‚­ãƒ¼é–¢ä¿‚

| FKå | ã‚«ãƒ©ãƒ  | å‚ç…§ãƒ†ãƒ¼ãƒ–ãƒ« | å‚ç…§ã‚«ãƒ©ãƒ  | æ›´æ–°æ™‚ | å‰Šé™¤æ™‚ | èª¬æ˜Ž |
|------|--------|--------------|------------|--------|--------|------|
| fk_WRK_BatchJobLog_executed_by | executed_by | MST_UserAuth | user_id | CASCADE | RESTRICT | å®Ÿè¡Œè€…ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æƒ…å ±ï¼‰ã¸ã®å¤–éƒ¨ã‚­ãƒ¼ |

## ðŸ“Š ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

| ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å | ã‚«ãƒ©ãƒ  | ä¸€æ„ | èª¬æ˜Ž |
|----------------|--------|------|------|
| idx_WRK_BatchJobLog_job_id | job_id | â— | ã‚¸ãƒ§ãƒ–IDæ¤œç´¢ç”¨ï¼ˆä¸€æ„ï¼‰ |
| idx_WRK_BatchJobLog_status | status |  | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ¤œç´¢ç”¨ï¼ˆå®Ÿè¡Œä¸­ã‚¸ãƒ§ãƒ–ã®ç›£è¦–ç­‰ï¼‰ |
| idx_WRK_BatchJobLog_start_time | start_time |  | é–‹å§‹æ™‚åˆ»æ¤œç´¢ç”¨ï¼ˆæ—¥æ™‚ç¯„å›²ã§ã®çµžã‚Šè¾¼ã¿ï¼‰ |
| idx_WRK_BatchJobLog_executed_by | executed_by |  | å®Ÿè¡Œè€…æ¤œç´¢ç”¨ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã‚¸ãƒ§ãƒ–å±¥æ­´ï¼‰ |
| idx_WRK_BatchJobLog_job_type | job_type |  | ã‚¸ãƒ§ãƒ–ç¨®åˆ¥æ¤œç´¢ç”¨ï¼ˆç¨®åˆ¥åˆ¥ã®çµ±è¨ˆç­‰ï¼‰ |
| idx_WRK_BatchJobLog_status_start_time | status, start_time |  | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨é–‹å§‹æ™‚åˆ»ã®è¤‡åˆæ¤œç´¢ç”¨ï¼ˆç›£è¦–ç”»é¢ã§ã®çµžã‚Šè¾¼ã¿ï¼‰ |

## âš ï¸ åˆ¶ç´„

| åˆ¶ç´„å | ç¨®åˆ¥ | æ¡ä»¶ | èª¬æ˜Ž |
|--------|------|------|------|
| chk_WRK_BatchJobLog_status | CHECK | status IN ('PENDING', 'RUNNING', 'COMPLETED', 'FAILED', 'CANCELLED') | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å€¤ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ |
| chk_WRK_BatchJobLog_job_type | CHECK | job_type IN ('SKILL_IMPORT', 'EMPLOYEE_IMPORT', 'BULK_UPDATE', 'BULK_DELETE', 'DATA_EXPORT') | ã‚¸ãƒ§ãƒ–ç¨®åˆ¥å€¤ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ |
| chk_WRK_BatchJobLog_records_positive | CHECK | total_records >= 0 AND processed_records >= 0 AND success_records >= 0 AND error_records >= 0 | ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°æ­£æ•°ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ |
| chk_WRK_BatchJobLog_progress_range | CHECK | progress_percentage >= 0.00 AND progress_percentage <= 100.00 | é€²æ—çŽ‡ç¯„å›²ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ï¼ˆ0-100%ï¼‰ |
| chk_WRK_BatchJobLog_time_consistency | CHECK | end_time IS NULL OR start_time IS NULL OR start_time <= end_time | é–‹å§‹æ™‚åˆ»ã¨çµ‚äº†æ™‚åˆ»ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ |
| chk_WRK_BatchJobLog_record_consistency | CHECK | processed_records <= total_records AND (success_records + error_records) <= processed_records | å‡¦ç†ä»¶æ•°ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯åˆ¶ç´„ |

## ðŸ“ ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿

### å®Œäº†ã—ãŸã‚¹ã‚­ãƒ«æƒ…å ±ä¸€æ‹¬ç™»éŒ²ã‚¸ãƒ§ãƒ–
```json
{
  "job_id": "JOB-001-20250601-001",
  "job_name": "ã‚¹ã‚­ãƒ«æƒ…å ±ä¸€æ‹¬ç™»éŒ²ï¼ˆ2025å¹´6æœˆåˆ†ï¼‰",
  "job_type": "SKILL_IMPORT",
  "status": "COMPLETED",
  "start_time": "2025-06-01 09:00:00",
  "end_time": "2025-06-01 09:15:30",
  "total_records": 500,
  "processed_records": 500,
  "success_records": 485,
  "error_records": 15,
  "error_details": "{\"errors\": [{\"row\": 23, \"column\": \"skill_level\", \"message\": \"ç„¡åŠ¹ãªã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«å€¤\"}, {\"row\": 45, \"column\": \"employee_id\", \"message\": \"å­˜åœ¨ã—ãªã„ç¤¾å“¡ID\"}]}",
  "input_file_path": "/uploads/skill_import_20250601.csv",
  "output_file_path": "/reports/skill_import_error_20250601.csv",
  "executed_by": "admin001",
  "progress_percentage": 100.00,
  "execution_environment": "batch-server-01:12345",
  "job_parameters": "{\"delimiter\": \",\", \"encoding\": \"UTF-8\", \"skip_header\": true}"
}
```

### å®Ÿè¡Œä¸­ã®ç¤¾å“¡æƒ…å ±ä¸€æ‹¬æ›´æ–°ã‚¸ãƒ§ãƒ–
```json
{
  "job_id": "JOB-002-20250601-002",
  "job_name": "ç¤¾å“¡éƒ¨ç½²æƒ…å ±ä¸€æ‹¬æ›´æ–°",
  "job_type": "BULK_UPDATE",
  "status": "RUNNING",
  "start_time": "2025-06-01 14:30:00",
  "end_time": null,
  "total_records": 1000,
  "processed_records": 650,
  "success_records": 640,
  "error_records": 10,
  "executed_by": "hr_manager001",
  "progress_percentage": 65.00,
  "execution_environment": "batch-server-02:23456"
}
```

## ðŸ“‹ ç‰¹è¨˜äº‹é …

- ãƒ¯ãƒ¼ã‚¯ç³»ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãŸã‚ã€å‡¦ç†å®Œäº†ã‹ã‚‰3ãƒ¶æœˆçµŒéŽå¾Œã«è‡ªå‹•ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
- å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ™‚ã¯progress_percentageã§é€²æ—ç›£è¦–å¯èƒ½
- error_detailsã¨job_parametersã¯JSONå½¢å¼ã§æŸ”è»Ÿãªæƒ…å ±æ ¼ç´
- å®Ÿè¡Œç’°å¢ƒæƒ…å ±ã«ã‚ˆã‚Šåˆ†æ•£å‡¦ç†æ™‚ã®è¿½è·¡ãŒå¯èƒ½
- å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯ç›¸å¯¾ãƒ‘ã‚¹ã¾ãŸã¯è«–ç†ãƒ‘ã‚¹ã§ç®¡ç†
- é•·æ™‚é–“å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã¯å®šæœŸçš„ã«progress_percentageæ›´æ–°
- ã‚·ã‚¹ãƒ†ãƒ éšœå®³æ™‚ã®å¾©æ—§ç”¨ã«execution_environmentæƒ…å ±ã‚’æ´»ç”¨

## ðŸ“ æ¥­å‹™ãƒ«ãƒ¼ãƒ«

- ã‚¸ãƒ§ãƒ–é–‹å§‹æ™‚ã«PENDINGã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ
- å®Ÿè¡Œé–‹å§‹æ™‚ã«RUNNINGã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«æ›´æ–°ã€start_timeè¨­å®š
- å‡¦ç†å®Œäº†æ™‚ã«COMPLETED/FAILEDã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«æ›´æ–°ã€end_timeè¨­å®š
- ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã¯å³åº§ã«error_detailsã«è©³ç´°æƒ…å ±è¨˜éŒ²
- é€²æ—çŽ‡ã¯å‡¦ç†æ¸ˆã¿ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°/ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã§è‡ªå‹•è¨ˆç®—
- åŒä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŒæ™‚å®Ÿè¡Œã‚¸ãƒ§ãƒ–æ•°ã¯æœ€å¤§3å€‹ã¾ã§åˆ¶é™
- RUNNINGçŠ¶æ…‹ã§24æ™‚é–“çµŒéŽã—ãŸã‚¸ãƒ§ãƒ–ã¯è‡ªå‹•çš„ã«FAILEDã«å¤‰æ›´
- ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèªå¾Œã«è¨­å®š
- å‡¦ç†å®Œäº†å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯7æ—¥é–“ä¿æŒå¾Œã«è‡ªå‹•å‰Šé™¤
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãŒç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã®50%ã‚’è¶…ãˆãŸå ´åˆã¯å‡¦ç†ä¸­æ–­

## ðŸ”„ æ”¹ç‰ˆå±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | ä½œæˆè€… | å¤‰æ›´å†…å®¹ |
|------------|------|--------|----------|
| 1.0.0 | 2025-06-01 | é–‹ç™ºãƒãƒ¼ãƒ  | åˆç‰ˆä½œæˆ - WRK_BatchJobLogã®è©³ç´°å®šç¾© |

---
*ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©æ›¸ã¯ `table-details/WRK_BatchJobLog_details.yaml` ã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ã€‚*
